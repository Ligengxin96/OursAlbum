(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{128:function(e,t,n){},129:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(10),r=n.n(c),i=n(73),s=n(36),o=n(12),l={posts:[],isLoading:!1},u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments.length>1?arguments[1]:void 0,n=e.posts,a=t.payload;switch(t.type){case"START_LOADING":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!0});case"END_LOADING":return Object(o.a)(Object(o.a)({},e),{},{isLoading:!1});case"FETCH_ALL":return Object(o.a)(Object(o.a)({},e),{},{posts:a});case"CREATE":return Object(o.a)(Object(o.a)({},e),{},{posts:n.concat(a)});case"UPDATE":var c=a[0];return Object(o.a)(Object(o.a)({},e),{},{posts:n.map((function(e){return e._id===c._id?c:e}))});case"DELETE":var r=a[0];return Object(o.a)(Object(o.a)({},e),{},{posts:n.filter((function(e){return e._id!==r._id}))});default:return e}},d=Object(s.b)({posts:u}),j=n(19),p=n(29),b=n(175),f=n(176),O=n(87),h=n(174),m=n(173),x=n(172),g=n(168),v=n(169),y=n(167),E=n(170),w=n(171),k=n(82),C=n.n(k),N=n(83),S=n.n(N),T=n(81),_=n.n(T),L=n(74),A=n.n(L),D=n(179),I=n(162),P=n(163),R=n(164),F=n(165),B=n(166),z=n(79),W=n.n(z),H=n(158),U=Object(H.a)({title:{display:"flex",textAlign:"center",alignItems:"center"},iconButton:{marginLeft:"3rem"}}),G=n(5),K=function(e){var t=e.isOpen,n=void 0!==t&&t,a=e.handleClose,c=U();return Object(G.jsx)("div",{children:Object(G.jsxs)(D.a,{open:n,onClose:a,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description",children:[Object(G.jsxs)(I.a,{id:"alert-dialog-title",className:c.title,children:["\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",a?Object(G.jsx)(P.a,{"aria-label":"close",onClick:function(){return a(0)},children:Object(G.jsx)(W.a,{className:c.iconButton})}):null]}),Object(G.jsx)(R.a,{children:Object(G.jsx)(F.a,{id:"alert-dialog-description",children:"\u5220\u9664\u540e\u5185\u5bb9\u5c06\u6c38\u4e45\u4e22\u5931,\u65e0\u6cd5\u6062\u590d!"})}),Object(G.jsxs)(B.a,{children:[Object(G.jsx)(y.a,{onClick:function(){return a(0)},color:"primary",children:"\u53d6\u6d88"}),Object(G.jsx)(y.a,{onClick:function(){return a(1)},color:"secondary",autoFocus:!0,children:"\u786e\u5b9a"})]})]})})},M=n(15),V=n.n(M),J=n(26),q=n(37),Q=n.n(q),X=n(80);n.n(X).a.config();var Y="dev"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).ENV?"http://localhost:5000/v1/post":"http://ours-album-server.herokuapp.com/v1/post",Z=function(e){return Q.a.post(Y,e)},$=function(e,t){return Q.a.patch("".concat(Y,"/").concat(e),t)},ee=function(e){return Q.a.patch("".concat(Y,"/likepost/").concat(e))},te=function(e){return Q.a.delete("".concat(Y,"/").concat(e))},ne=function(e){return function(){var t=Object(J.a)(V.a.mark((function t(n){var a,c;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Z(e);case 3:a=t.sent,c=a.data,n({type:"CREATE",payload:c.data}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("Error occurrence when create post with error:",t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()},ae=function(e,t){return function(){var n=Object(J.a)(V.a.mark((function n(a){var c,r;return V.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,$(e,t);case 3:c=n.sent,r=c.data,a({type:"UPDATE",payload:r.data}),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),console.log("Error occurrence when update post with error:",n.t0.message);case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()},ce=n.p+"static/media/null.09cb794a.png",re=Object(H.a)({media:{height:0,paddingTop:"56.25%",backgroundColor:"rgba(0, 0, 0, 0.5)",backgroundBlendMode:"darken"},border:{border:"solid"},fullHeightCard:{height:"100%"},card:{display:"flex",flexDirection:"column",justifyContent:"space-between",borderRadius:"15px",height:"100%",position:"relative"},overlayLeft:{position:"absolute",top:"20px",left:"20px",color:"white"},overlayRight:{position:"absolute",top:"20px",right:"20px",color:"white"},grid:{display:"flex"},details:{display:"flex",justifyContent:"space-between",margin:"20px"},title:{padding:"0 16px"},cardActions:{padding:"0 16px 8px 16px",display:"flex",justifyContent:"space-between"},likes:{paddingLeft:"3px"}}),ie=function(e){var t=e.post,n=e.setEditingPostId,c=re(),r=Object(j.b)(),i=Object(a.useState)(null),s=Object(p.a)(i,2),o=s[0],l=s[1],u=Object(a.useState)(!1),d=Object(p.a)(u,2),b=d[0],f=d[1],h=function(e){l(e),f(!0)},m=function(e){r(function(e){return function(){var t=Object(J.a)(V.a.mark((function t(n){var a,c;return V.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,ee(e);case 3:a=t.sent,c=a.data,n({type:"UPDATE",payload:c.data}),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.log("Error occurrence when like post with error:",t.t0.message);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(e))};return Object(G.jsxs)("div",{children:[Object(G.jsxs)(g.a,{className:c.card,children:[Object(G.jsx)(v.a,{className:c.media,title:t.title,image:t.selectedFile||ce}),Object(G.jsxs)("div",{className:c.overlayLeft,children:[Object(G.jsx)(O.a,{variant:"h6",children:t.creator}),Object(G.jsx)(O.a,{variant:"body2",children:A()(t.createdTime).fromNow()})]}),Object(G.jsx)("div",{className:c.overlayRight,children:Object(G.jsx)(y.a,{style:{color:"white"},size:"small",onClick:function(){return e=t._id,void n(e);var e},children:Object(G.jsx)(_.a,{fontSize:"default"})})}),Object(G.jsx)("div",{className:c.details,children:Object(G.jsx)(O.a,{variant:"body2",color:"textSecondary",component:"h2",children:t.tags.map((function(e){return"#".concat(e," ")}))})}),Object(G.jsx)(O.a,{className:c.title,gutterBottom:!0,variant:"h5",component:"h2",children:t.title}),Object(G.jsx)(E.a,{children:Object(G.jsx)(O.a,{variant:"body2",color:"textSecondary",component:"p",children:t.message})}),Object(G.jsxs)(w.a,{className:c.cardActions,children:[Object(G.jsxs)(y.a,{size:"small",color:"primary",onClick:function(){return m(t._id)},children:[Object(G.jsx)(C.a,{fontSize:"small"}),Object(G.jsx)("span",{className:c.likes,children:t.likeCount})]}),Object(G.jsx)(y.a,{size:"small",color:"secondary",onClick:function(){return h(t._id)},children:Object(G.jsx)(S.a,{fontSize:"small"})})]})]}),Object(G.jsx)(K,{isOpen:b,handleClose:function(e){var t;1===e&&(r((t=o,function(){var e=Object(J.a)(V.a.mark((function e(n){var a,c;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,te(t);case 3:a=e.sent,c=a.data,n({type:"DELETE",payload:c.data}),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),console.log("Error occurrence when delete post with error:",e.t0.message);case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(t){return e.apply(this,arguments)}}())),l(null)),f(!1)}})]})},se=Object(H.a)((function(e){return{mainContainer:{display:"flex",alignItems:"center"},smMargin:{margin:e.spacing(1)},actionDiv:{textAlign:"center"}}})),oe=function(e){var t=e.setEditingPostId,n=Object(j.c)((function(e){return e.posts})),a=n.posts,c=n.isLoading,r=se();return Object(G.jsx)("div",{children:c?Object(G.jsx)(x.a,{}):Object(G.jsx)(m.a,{className:r.container,container:!0,alignItems:"stretch",spacing:3,children:a.map((function(e,n){return Object(G.jsx)(m.a,{item:!0,xs:12,sm:6,md:6,children:Object(G.jsx)(ie,{post:e,setEditingPostId:t})},n)}))})})},le=n(38),ue=n(86),de=n(177),je=n(84),pe=n.n(je),be=Object(H.a)((function(e){return{root:{"& .MuiTextField-root":{margin:e.spacing(1)}},paper:{padding:e.spacing(2)},form:{display:"flex",flexWrap:"wrap",justifyContent:"center"},filedInput:{width:"97%",margin:"10px 0"},buttonSubmit:{marginBottom:10}}})),fe=[{name:"creator",label:"\u521b\u5efa\u8005"},{name:"title",label:"\u6807\u9898"},{name:"message",label:"\u63cf\u8ff0",multiline:!0},{name:"tags",label:"\u6807\u7b7e(\u9017\u53f7\u5206\u9694)"}],Oe=function(e){var t=e.id,n=e.setEditingPostId,c=be(),r=Object(j.b)(),i=Object(j.c)((function(e){return e.posts.posts.find((function(e){return e._id===t}))})),s=Object(a.useState)({creator:"",title:"",message:"",tags:[],selectedFile:""}),l=Object(p.a)(s,2),u=l[0],d=l[1],b=function(){d({creator:"",title:"",message:"",tags:[],selectedFile:""}),n(null)},f=function(){var e=Object(J.a)(V.a.mark((function e(n){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),r(t?ae(t,u):ne(u)),b();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.useEffect)((function(){i&&d(i)}),[i]),Object(G.jsx)(ue.a,{className:c.paper,children:Object(G.jsxs)("form",{autoComplete:"off",noValidate:!0,className:"".concat(c.root," ").concat(c.form),onSubmit:f,children:[Object(G.jsx)(O.a,{variant:"h6",children:"".concat(t?"\u7f16\u8f91":"\u521b\u5efa","\u6211\u4eec\u7684\u56de\u5fc6")}),fe.map((function(e){var t=e.name,n=e.label,a=e.multiline,c=void 0!==a&&a;return Object(G.jsx)(de.a,{value:u[t],onChange:function(e){return function(e,t){d("tags"===t?Object(o.a)(Object(o.a)({},u),{},Object(le.a)({},t,e.target.value.split(","))):Object(o.a)(Object(o.a)({},u),{},Object(le.a)({},t,e.target.value)))}(e,t)},name:t,label:n,multiline:c,variant:"outlined",fullWidth:!0},t)})),Object(G.jsx)("div",{className:c.filedInput,children:Object(G.jsx)(pe.a,{type:"file",value:u.selectedFile,multiple:!1,onDone:function(e){d(Object(o.a)(Object(o.a)({},u),{},{selectedFile:e.base64}))}})}),Object(G.jsx)(y.a,{className:c.buttonSubmit,variant:"contained",color:"primary",size:"large",type:"submit",fullWidth:!0,children:"\u63d0\u4ea4"}),Object(G.jsx)(y.a,{variant:"contained",color:"secondary",size:"small",fullWidth:!0,onClick:b,children:"\u53d6\u6d88"})]})})},he=n.p+"static/media/us.9cfa8a46.png",me=Object(H.a)((function(){return{appBar:{borderRadius:15,margin:"30px 0",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center"},heading:{color:"rgba(0,183,255, 1)"},image:{marginLeft:"15px"}}})),xe=function(){var e=me(),t=Object(j.b)(),n=Object(a.useState)(null),c=Object(p.a)(n,2),r=c[0],i=c[1];return Object(a.useEffect)((function(){t(function(){var e=Object(J.a)(V.a.mark((function e(t){var n,a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t({type:"START_LOADING"}),e.next=4,Q.a.get(Y);case 4:n=e.sent,a=n.data,t({type:"FETCH_ALL",payload:a.data}),t({type:"END_LOADING"}),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.log("Error occurrence when fetch all posts with error:",e.t0.message);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})));return function(t){return e.apply(this,arguments)}}())}),[t]),Object(G.jsxs)(b.a,{maxWidth:"lg",children:[Object(G.jsxs)(f.a,{className:e.appBar,position:"static",color:"inherit",children:[Object(G.jsx)(O.a,{className:e.heading,variant:"h2",align:"center",children:"Ours Album"}),Object(G.jsx)("img",{className:e.image,src:he,alt:"icon",height:"60"})]}),Object(G.jsx)(h.a,{in:!0,children:Object(G.jsx)(b.a,{children:Object(G.jsxs)(m.a,{container:!0,justify:"space-between",alignItems:"stretch",spacing:3,children:[Object(G.jsx)(m.a,{item:!0,xs:12,sm:7,children:Object(G.jsx)(oe,{setEditingPostId:i})}),Object(G.jsx)(m.a,{item:!0,xs:12,sm:4,children:Object(G.jsx)(Oe,{id:r,setEditingPostId:i})})]})})})]})},ge=(n(128),Object(s.d)(d,Object(s.c)(Object(s.a)(i.a))));r.a.render(Object(G.jsx)(j.a,{store:ge,children:Object(G.jsx)(xe,{})}),document.getElementById("root"))}},[[129,1,2]]]);
//# sourceMappingURL=main.5edfe4c8.chunk.js.map